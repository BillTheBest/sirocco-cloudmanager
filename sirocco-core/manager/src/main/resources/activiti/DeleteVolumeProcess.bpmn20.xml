<?xml version="1.0" encoding="UTF-8"?>
<!-- 

   SIROCCO
   Copyright (C) 2013 France Telecom
   Contact: sirocco@ow2.org

   This library is free software; you can redistribute it and/or
   modify it under the terms of the GNU Lesser General Public
   License as published by the Free Software Foundation; either
   version 2.1 of the License, or any later version.

   This library is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   Lesser General Public License for more details.

   You should have received a copy of the GNU Lesser General Public
   License along with this library; if not, write to the Free Software
   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307
   USA

-->
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/test">
  <message id="MessageCreateVolumeProcessGetPlacement" name="MessageCreateVolumeProcessGetPlacement"></message>
  <message id="MessageCreateVolumeProcessConnectorCreateVolume" name="MessageCreateVolumeProcessConnectorCreateVolume"></message>
  <process id="DeleteVolumeProcess" name="DeleteVolumeProcess" isExecutable="true">
    <startEvent id="startevent1" name="Start"></startEvent>
    <endEvent id="theEnd" name="End"></endEvent>
    <exclusiveGateway id="exclusivegateway1" name="Event Gateway" default="flow42"></exclusiveGateway>
    <serviceTask id="VerifyArgsService" name="VerifyArgs" activiti:async="true" activiti:delegateExpression="${VerifyArgs}"></serviceTask>
    <serviceTask id="createJobService" name="createJob" activiti:delegateExpression="${CreateJob}"></serviceTask>
    <sequenceFlow id="flow1" sourceRef="startevent1" targetRef="VerifyArgsService"></sequenceFlow>
    <sequenceFlow id="flow19" sourceRef="exclusivegateway1" targetRef="createJobService">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${!JOB_GIVEN}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow40" sourceRef="VerifyArgsService" targetRef="exclusivegateway1"></sequenceFlow>
    <sequenceFlow id="flow41" sourceRef="createJobService" targetRef="connectorCallService"></sequenceFlow>
    <sequenceFlow id="flow42" sourceRef="exclusivegateway1" targetRef="connectorCallService">
      <!-- <conditionExpression xsi:type="tFormalExpression"><![CDATA[${JOB_GIVEN}]]></conditionExpression> -->
    </sequenceFlow>
    <serviceTask id="updateBeans" name="updateBeans" activiti:delegateExpression="${VolumeUpdateBeans}"></serviceTask>
    <sequenceFlow id="flow44" sourceRef="callactivity1" targetRef="updateBeans"></sequenceFlow>
    <sequenceFlow id="flow45" sourceRef="updateBeans" targetRef="theEnd"></sequenceFlow>
    <callActivity id="callactivity1" name="Connector Polling" calledElement="PollingProcess">
      <extensionElements>
        <activiti:in source="INPUT_OBJECTID" target="INPUT_OBJECTID"></activiti:in>
        <activiti:in source="INPUT_OBJECT_TYPE" target="INPUT_OBJECT_TYPE"></activiti:in>
        <activiti:in source="INPUT_INITIAL_STATE" target="INPUT_INITIAL_STATE"></activiti:in>
        <activiti:out source="OUTPUT_OBJECT_STATE" target="OUTPUT_OBJECT_STATE"></activiti:out>
      </extensionElements>
    </callActivity>
    <serviceTask id="connectorCallService" name="connectorCall" activiti:delegateExpression="${VolumeDeleteConnectorCall}"></serviceTask>
    <sequenceFlow id="flow46" sourceRef="connectorCallService" targetRef="callactivity1"></sequenceFlow>
    <boundaryEvent id="boundaryerror1" name="Error" attachedToRef="callactivity1">
      <errorEventDefinition></errorEventDefinition>
    </boundaryEvent>
    <serviceTask id="processErrorService" name="processError" activiti:delegateExpression="${VolumeProcessError}"></serviceTask>
    <sequenceFlow id="flow47" sourceRef="boundaryerror1" targetRef="processErrorService"></sequenceFlow>
    <sequenceFlow id="flow48" sourceRef="processErrorService" targetRef="theEnd"></sequenceFlow>
    <boundaryEvent id="boundaryerror2" name="Error" attachedToRef="connectorCallService">
      <errorEventDefinition></errorEventDefinition>
    </boundaryEvent>
    <sequenceFlow id="flow49" sourceRef="boundaryerror2" targetRef="processErrorService"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_DeleteVolumeProcess">
    <bpmndi:BPMNPlane bpmnElement="DeleteVolumeProcess" id="BPMNPlane_DeleteVolumeProcess">
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="-20.0" y="193.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="theEnd" id="BPMNShape_theEnd">
        <omgdc:Bounds height="35.0" width="35.0" x="970.0" y="193.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="177.0" y="190.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="VerifyArgsService" id="BPMNShape_VerifyArgsService">
        <omgdc:Bounds height="55.0" width="105.0" x="40.0" y="183.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="createJobService" id="BPMNShape_createJobService">
        <omgdc:Bounds height="55.0" width="105.0" x="240.0" y="240.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="updateBeans" id="BPMNShape_updateBeans">
        <omgdc:Bounds height="55.0" width="105.0" x="830.0" y="183.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="boundaryerror1" id="BPMNShape_boundaryerror1">
        <omgdc:Bounds height="30.0" width="30.0" x="750.0" y="160.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="callactivity1" id="BPMNShape_callactivity1">
        <omgdc:Bounds height="78.0" width="164.0" x="640.0" y="172.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="connectorCallService" id="BPMNShape_connectorCallService">
        <omgdc:Bounds height="55.0" width="105.0" x="500.0" y="183.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="processErrorService" id="BPMNShape_processErrorService">
        <omgdc:Bounds height="55.0" width="105.0" x="830.0" y="60.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="boundaryerror2" id="BPMNShape_boundaryerror2">
        <omgdc:Bounds height="30.0" width="30.0" x="560.0" y="172.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow1" id="BPMNEdge_flow1">
        <omgdi:waypoint x="15.0" y="210.0"></omgdi:waypoint>
        <omgdi:waypoint x="40.0" y="210.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow19" id="BPMNEdge_flow19">
        <omgdi:waypoint x="197.0" y="230.0"></omgdi:waypoint>
        <omgdi:waypoint x="197.0" y="267.0"></omgdi:waypoint>
        <omgdi:waypoint x="240.0" y="267.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow45" id="BPMNEdge_flow45">
        <omgdi:waypoint x="935.0" y="210.0"></omgdi:waypoint>
        <omgdi:waypoint x="970.0" y="210.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow40" id="BPMNEdge_flow40">
        <omgdi:waypoint x="145.0" y="210.0"></omgdi:waypoint>
        <omgdi:waypoint x="177.0" y="210.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow41" id="BPMNEdge_flow41">
        <omgdi:waypoint x="345.0" y="267.0"></omgdi:waypoint>
        <omgdi:waypoint x="411.0" y="265.0"></omgdi:waypoint>
        <omgdi:waypoint x="552.0" y="238.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow42" id="BPMNEdge_flow42">
        <omgdi:waypoint x="217.0" y="210.0"></omgdi:waypoint>
        <omgdi:waypoint x="500.0" y="210.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow44" id="BPMNEdge_flow44">
        <omgdi:waypoint x="804.0" y="211.0"></omgdi:waypoint>
        <omgdi:waypoint x="830.0" y="210.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow46" id="BPMNEdge_flow46">
        <omgdi:waypoint x="605.0" y="210.0"></omgdi:waypoint>
        <omgdi:waypoint x="640.0" y="211.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow47" id="BPMNEdge_flow47">
        <omgdi:waypoint x="765.0" y="160.0"></omgdi:waypoint>
        <omgdi:waypoint x="764.0" y="87.0"></omgdi:waypoint>
        <omgdi:waypoint x="830.0" y="87.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow48" id="BPMNEdge_flow48">
        <omgdi:waypoint x="882.0" y="115.0"></omgdi:waypoint>
        <omgdi:waypoint x="987.0" y="193.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow49" id="BPMNEdge_flow49">
        <omgdi:waypoint x="575.0" y="172.0"></omgdi:waypoint>
        <omgdi:waypoint x="574.0" y="87.0"></omgdi:waypoint>
        <omgdi:waypoint x="830.0" y="87.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>